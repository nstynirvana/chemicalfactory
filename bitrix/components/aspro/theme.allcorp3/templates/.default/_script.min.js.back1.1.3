var timerHide=!1,timerDynamicLeftSide=!1,timerResponse=!1,hoveredSwitcher=!1;function checkDelay(parent){window.NO_WIDGET_TIMEOUT=!1,parent&&"Y"===parent.data("no-delay")&&(window.NO_WIDGET_TIMEOUT=!0)}function saveFrontParameter(params){paramsDefault={VALUE:"",NAME:"",OPTIONS:{},RELOAD:!1},params=Object.assign({},paramsDefault,params),$(".sharepreset-part--export").removeClass("sharepreset-part--exported2Link"),$.post(arAsproOptions.SITE_DIR+"ajax/options_save_mainpage.php",{VALUE:params.VALUE,NAME:params.NAME},(function(){reloadBlock(params.OPTIONS)})),params.RELOAD&&setTimeout((function(){$("form[name=style-switcher]").submit()}),200)}function reloadBlock(options){if($(".sharepreset-part--export").removeClass("sharepreset-part--exported2Link"),options.ajaxParent&&options.ajaxParent.length){options.parent&&options.parent.length&&(options.checked?options.parent.removeClass("disabled"):options.parent.addClass("disabled"));var pageBlock=options.ajaxParent.data("pageBlock"),target=options.element.closest(".option-ajax-target");if(target.length)var targetSelector=target.data("needBlock");pageBlock&&BX.ajax({url:location.href,method:"POST",data:{BLOCK:targetSelector,IS_AJAX:"Y"},onsuccess:function(html){if(html){var targetBlock=$('[data-ajax-load-block="'+targetSelector+'"]');if(targetBlock.length){var callback=options.ajaxParent.data("ajaxCallback");callback&&"function"==typeof window[callback]&&setTimeout((function(){window[callback](targetBlock)}),0),targetBlock.replaceWith(html),~targetSelector.indexOf("EYED")&&"function"==typeof JEyed&&BX("eyed-panel")&&"object"==typeof BX("eyed-panel").eyed&&BX("eyed-panel").eyed.checkState()}}}})}}window.array=[],$(document).ready((function(){checkNeedRequest=function(){return $(".style-switcher-body.loading_block").length},getExternalNews=function(){$(".section-block.updates_tab").hasClass("hidden")&&$.ajax({url:"https://aspro.ru/demo/updates/index.php",type:"POST",data:{AJAX_FORM:"Y"},success:function(html){$(".section-block.updates_tab").removeClass("hidden"),$(".right-block .inner-content .contents.updates .body_block").html(html)},error:function(jqXhr){console.log(jqXhr)}})},getWidgetHtml=function(callback){if(checkNeedRequest()){if(!$(".top_block_switch").hasClass("loading")){$(".top_block_switch").addClass("loading");try{BX.ajax({url:arAsproOptions.SITE_DIR+"?BLOCK=widget",method:"POST",data:BX.ajax.prepareData({ajax:"Y"}),dataType:"html",processData:!1,start:!0,headers:[{name:"X-Requested-With",value:"XMLHttpRequest"}],onfailure:function(error){console.error(error)},onsuccess:function(html){var ob=BX.processHTML(html);BX.loadCSS(ob.STYLE),setTimeout((function(){$(".top_block_switch").removeClass("loading"),$(".style-switcher-body").removeClass("loading_block").html(ob.HTML),BX.ajax.processScripts(ob.SCRIPT)}),100),"function"==typeof callback&&setTimeout((function(){callback()}),150)}})}catch(error){console.error(error)}}}else"function"==typeof callback&&callback()},HideHintBlock=function(bHideOverlay){(void 0===bHideOverlay||bHideOverlay)&&HideOverlay(),$.cookie("clickedSwitcher","Y",{path:"/"}),$(".hint-theme").length&&$(".hint-theme").fadeIn(300,(function(){$(".hint-theme").remove()}))};var submitTimer=!1,bCanSubmit=!1;function closeActiveSwitcherPopups(){var activePopup=$(".switcher-select__popup.active");activePopup.length&&activePopup.removeClass("active")}$("form[name=style-switcher]").submit((function(e){var $form=$(this);bCanSubmit||(e.preventDefault(),submitTimer&&(clearTimeout(submitTimer),submitTimer=!1),window.NO_WIDGET_TIMEOUT?(bCanSubmit=!0,$form.submit()):submitTimer=setTimeout((function(){bCanSubmit=!0,$form.submit()}),1500))})),$(".top_block_switch").mouseenter((function(){getWidgetHtml(),hoveredSwitcher=!0})),$("html, body").on("mousedown",(function(e){"string"==typeof e.target.className&&e.target.className.indexOf("adm")<0&&(e.stopPropagation(),$(e.target).closest(".style-switcher .dynamic_left_side").length||$(".style-switcher .dynamic_left_side").removeClass("active"),$(e.target).closest(".style-switcher .contents.wizard").length||$(".style-switcher .contents.wizard").removeClass("active"))})),$(".dynamic_left_side").find("*").on("mousedown",(function(e){e.stopPropagation()})),$(document).on("click",".presets .thematik .item",(function(){var thematic=$(this).data("code");selectThematic(thematic,!0)})),$(document).on("click",".style-switcher .presets .preset-block .apply_conf_block",(function(e){var preset=$(this).closest(".preset-block").data("id");selectPreset(preset)})),$(document).on("click",".style-switcher .switch",(function(e){e.preventDefault();var _this=$(this),styleswitcher=_this.closest(".style-switcher"),bSwitchPresets=_this.hasClass("presets_action"),topBlockSwitch=_this.closest("top_block_switch");checkNeedRequest()?(_this.addClass("loadings"),timerResponse=setInterval((function(){checkNeedRequest()&&hoveredSwitcher||(clearInterval(timerResponse),setWidgetHtml(styleswitcher,_this,bSwitchPresets))}),50)):setWidgetHtml(styleswitcher,_this,bSwitchPresets)})),setWidgetHtml=function(styleswitcher,_this,bSwitchPresets){getWidgetHtml((function(){var presets=styleswitcher.find(".presets"),parametrs=styleswitcher.find(".parametrs");if(styleswitcher.find(".section-block").removeClass("active"),_this.removeClass("loadings"),getExternalNews(),"function"==typeof getAjaxForm&&getAjaxForm((function(){$(".section-block.demos_tab").removeClass("hidden")})),styleswitcher.hasClass("active")){restoreThematics();var typeSwitcher=$.cookie("styleSwitcherType");styleswitcher.find(".switch").removeClass("active"),styleswitcher.find(".presets_action").removeClass("active"),bSwitchPresets&&"presets"===typeSwitcher||!bSwitchPresets&&"parametrs"===typeSwitcher?(HideHintBlock(!0),$.removeCookie("styleSwitcherType",{path:"/"}),$.removeCookie("styleSwitcher",{path:"/"}),styleswitcher.addClass("closes"),setTimeout((function(){styleswitcher.removeClass("active")}),300)):(HideHintBlock(!1),$.cookie("styleSwitcherType",bSwitchPresets?"presets":"parametrs",{path:"/"}),styleswitcher.find(".header .title").hide(),bSwitchPresets?($(".section-block.presets_tab").addClass("active"),presets.addClass("active"),parametrs.removeClass("active")):$(this).hasClass("demo_action")?($(".section-block.demos_tab").removeClass("hidden").addClass("active"),$(".inner-content .contents").removeClass("active"),$(".inner-content .contents.demos").removeClass("hidden").addClass("active"),$.removeCookie("styleSwitcherType",{path:"/"}),$.removeCookie("styleSwitcher",{path:"/"})):($(".section-block.parametrs_tab").addClass("active"),presets.removeClass("active"),parametrs.addClass("active")),$(this).addClass("active"))}else HideHintBlock(!0),_this.addClass("active"),$.cookie("styleSwitcherType",bSwitchPresets?"presets":"parametrs",{path:"/"}),$.cookie("styleSwitcher","open",{path:"/"}),bSwitchPresets?($(".section-block.presets_tab").addClass("active"),presets.addClass("active"),parametrs.removeClass("active")):_this.hasClass("demo_action")?($(".section-block.demos_tab").removeClass("hidden").addClass("active"),$(".inner-content .contents").removeClass("active"),$(".inner-content .contents.demos").removeClass("hidden").addClass("active"),$.removeCookie("styleSwitcherType",{path:"/"}),$.removeCookie("styleSwitcher",{path:"/"})):($(".section-block.parametrs_tab").addClass("active"),presets.removeClass("active"),parametrs.addClass("active")),ShowOverlay(),styleswitcher.removeClass("closes").addClass("active");void 0!==$(this).data("option-type")&&$.cookie("scroll_block",$(this).data("option-type"))}))},$(document).on("click",".close-overlay",(function(){HideHintBlock()})),$(".close_block").click((function(){$(".jqmOverlay").trigger("click")})),$(document).on("click",".jqmOverlay",(function(){var styleswitcher=$(".style-switcher");$(".hint-theme").length||HideOverlay(),styleswitcher.each((function(){var _this=$(this);_this.addClass("closes"),setTimeout((function(){_this.removeClass("active")}),300),$(".form_demo-switcher").animate({left:"-"+$(".form_demo-switcher").outerWidth()+"px"},100).removeClass("active abs")})),$(".style-switcher .switch,.style-switcher .presets_action").removeClass("active"),restoreThematics(),$.removeCookie("styleSwitcherType",{path:"/"}),$.removeCookie("styleSwitcher",{path:"/"})})),$(document).on("click",".sharepreset-trigger-open",(function(e){e.preventDefault(),$(".section-block.share_tab").trigger("click")})),$(document).on("click",".style-switcher .apply",(function(){$("form[name=style-switcher]").submit()})),$(document).on("click",".style-switcher .preview_conf_block .btn",(function(){var _this=$(this);$(".dynamic_left_side").length&&$(".dynamic_left_side").remove(),$('<div class="dynamic_left_side"><div class="items_inner"><div class="titles_block"></div></div></div>').appendTo(_this.closest(".contents.presets .presets_block")),$(".dynamic_left_side .titles_block").html('<div class="title">'+_this.closest(".preset-block").find(".info .title").text()+'</div><div class="blocks_wrapper"><div class="cl" title="'+BX.message("FANCY_CLOSE")+'">'+$(".close_block .closes").html()+"</div>"+(_this.closest(".preset-block").find(".apply_conf_block").hasClass("hidden")?"":'<div class="ch" data-id="'+_this.closest(".preset-block").data("id")+'">'+_this.closest(".preset-block").find(".apply_conf_block").html()+"</div>")+"</div>"),$('<div class="desc">'+_this.closest(".preset-block").find(".info .description").text()+"</div>").appendTo($(".dynamic_left_side .items_inner")),_this.closest(".preset-block").find(".info .description").data("img")&&$('<div class="img"><img src="'+_this.closest(".preset-block").find(".info .description").data("img")+'" /></div>').appendTo($(".dynamic_left_side .items_inner")),timerDynamicLeftSide&&(clearTimeout(timerDynamicLeftSide),timerDynamicLeftSide=!1),timerDynamicLeftSide=setTimeout((function(){$(".dynamic_left_side").addClass("active scrollbar")}),100)})),$(document).on("click",".dynamic_left_side .ch .btn",(function(e){var preset=$(this).parent().data("id");selectPreset(preset),$(".dynamic_left_side").removeClass("active")})),$(document).on("click",".dynamic_left_side .cl",(function(e){$(".dynamic_left_side").removeClass("active")})),$(document).on("click",".style-switcher .toggle-options__link",(function(){var _this,tab=$(this).data("tab");if(tab){var targetTab=$(".style-switcher .subsection-block[data-code="+tab+"]");if(targetTab.length){targetTab.trigger("click");var backButton=$(".block-item."+tab+" ."+tab+"_BACK_BUTTON");backButton.length&&backButton.show()}}})),$(document).on("click",".style-switcher .switcher__back-button",(function(){var _this=$(this),targetTab=$(".style-switcher .subsection-block[data-code=HEADER]");targetTab.length&&(_this.closest(".item").hide(),targetTab.trigger("click"))})),$(document).on("click",".style-switcher .toggle-parent",(function(e){var _this=$(this),target=_this.siblings(".toggle-target");(target=target.length?target:_this.find(".toggle-target")).length&&target.slideToggle()})),$(document).on("click",".switcher-select__current",(function(){var _this,popup=$(this).siblings(".switcher-select__popup"),bActive=popup.hasClass("active");closeActiveSwitcherPopups(),popup.length&&(bCanSubmit=!1,submitTimer&&(clearTimeout(submitTimer),submitTimer=!1),bActive?popup.removeClass("active"):popup.addClass("active"))})),$(document).on("click",(function(e){var _target=$(e.target);_target.hasClass("switcher-select__popup-item")||_target.hasClass("switcher-select__current")||closeActiveSwitcherPopups()})),$(document).on("click",".switcher-select__popup-item",(function(){var _this=$(this),value=_this.data("value"),title=_this.data("title"),parent=_this.closest(".switcher-select"),current;if(!(current=_this.hasClass("switcher-select__popup-item--current"))&&parent.length){var input=parent.find(".switcher-select__input"),saveParams,saveParams,current;if(input.length)if(input.val(value),_this.closest(".link-item").length)if(_this.closest(".link-item.current").length)saveFrontParameter(saveParams={VALUE:value,NAME:input.attr("name"),RELOAD:!0});else _this.closest(".link-item").trigger("click");else saveFrontParameter(saveParams={VALUE:value,NAME:input.attr("name"),RELOAD:!0});(current=parent.find(".switcher-select__current")).length&&current.text(title),parent.find(".switcher-select__popup-item--current").removeClass("switcher-select__popup-item--current"),_this.addClass("switcher-select__popup-item--current")}var popup=_this.closest(".switcher-select__popup");popup.length&&popup.toggleClass("active")})),$(document).on("change",".bottom-options input",(function(){var _this=$(this),value,saveParams;saveFrontParameter({VALUE:_this.val(),NAME:_this.attr("name"),RELOAD:!0})})),$(document).on("click",".style-switcher [data-option-id=SIDE_MENU]",(function(){$.cookie("side_menu","Y")}))}));
//# sourceMappingURL=script.min.js.map